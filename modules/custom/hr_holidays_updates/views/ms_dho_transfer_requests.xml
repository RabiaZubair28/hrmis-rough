<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!--
      MS DHO: extend the Transfer Requests page to show 4 tabs
      (similar to how custom_section_officers inherits templates).
    -->
    <template id="hrmis_msdho_transfer_requests_inherit_tabs"
              inherit_id="hr_holidays_updates.hrmis_transfer_requests"
              priority="50">

        <!-- Replace header tabs -->
        <xpath expr="//div[contains(@class,'hrmis-panel__header') and contains(@class,'hrmis-panel__header--tabs')]" position="replace">
            <t t-if="request.env.user.has_group('custom_login.group_ms_dho')">
                <div class="hrmis-panel__header hrmis-panel__header--tabs hrmis-panel__header--tabs--leave">
                    <a t-attf-class="hrmis-tab #{'is-active' if tab == 'new' else ''}"
                       t-att-href="'/hrmis/transfer?tab=new'">New Transfer Request</a>
                    <a t-attf-class="hrmis-tab #{'is-active' if tab == 'history' else ''}"
                       t-att-href="'/hrmis/transfer?tab=history'">Transfer History</a>
                    <a t-attf-class="hrmis-tab #{'is-active' if tab == 'status' else ''}"
                       t-att-href="'/hrmis/transfer?tab=status'">Transfer Status</a>
                    <a t-attf-class="hrmis-tab #{'is-active' if tab == 'requests' else ''}"
                       t-att-href="'/hrmis/transfer?tab=requests'">Transfer Requests</a>
                </div>
            </t>
            <t t-else="">
                <!-- original (2 tabs) -->
                <div class="hrmis-panel__header hrmis-panel__header--tabs hrmis-panel__header--tabs--leave">
                    <a t-attf-class="hrmis-tab #{'is-active' if tab == 'history' else ''}"
                       t-att-href="'/hrmis/transfer?tab=history'">Transfer History</a>
                    <a t-attf-class="hrmis-tab #{'is-active' if tab == 'new' else ''}"
                       t-att-href="'/hrmis/transfer?tab=new'">New Transfer Request</a>
                </div>
            </t>
        </xpath>

        <!-- Replace the base history block with MS DHO 4-tab renderer -->
        <xpath expr="//t[@t-if=&quot;tab == 'history'&quot;]" position="replace">
            <t t-if="request.env.user.has_group('custom_login.group_ms_dho')">
                <t t-if="tab == 'new'">
                    <t t-call="hrmis_transfer.hrmis_new_transfer_request"/>
                </t>
                <t t-elif="tab == 'history'">
                    <div class="hrmis-panel__body">
                        <t t-call="hrmis_transfer.hrmis_transfer_history"/>
                    </div>
                </t>
                <t t-elif="tab == 'status'">
                    <div class="hrmis-panel__body">
                        <t t-call="hrmis_transfer.hrmis_transfer_status"/>
                    </div>
                </t>
                <t t-elif="tab == 'requests'">
                    <t t-call="hrmis_transfer.hrmis_transfer_requests_list"/>
                </t>
                <t t-else="">
                    <div class="hrmis-panel__body">
                        <div class="hrmis-empty">Invalid tab.</div>
                    </div>
                </t>
            </t>
            <t t-else="">
                <!-- original history block -->
                <t t-if="tab == 'history'">
                    <div class="hrmis-panel__body">
                        <t t-call="hr_holidays_updates.hrmis_under_construction_block"/>
                    </div>
                </t>
            </t>
        </xpath>

        <!-- Replace the base new block (MS DHO new is handled above) -->
        <xpath expr="//t[@t-if=&quot;tab == 'new'&quot;]" position="replace">
            <t t-if="request.env.user.has_group('custom_login.group_ms_dho')">
                <t t-if="False"/>
            </t>
            <t t-else="">
                <!-- original new block -->
                <t t-if="tab == 'new'">
                    <t t-call="hrmis_transfer.hrmis_new_transfer_request"/>
                </t>
            </t>
        </xpath>
    </template>
</odoo>

